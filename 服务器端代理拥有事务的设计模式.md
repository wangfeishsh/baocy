当您在应用架构中用到命令模式\(Command Pattern\)或服务器端代理设计模式\(Server Delegate Design pattern\)时,本章描述的事务设计模式就比较适合了。在本模式中,服务器 端代理组件,作为对服务器的远程接入点,拥有事务并负责对事务实施全面的管理。其他任 何组件,包括客户端组件、领域服务组件、或是持久化组件都不负责管理事务,它们甚至不 会察觉到它们正在使用到了事务。

命令模式是一种非常有用的设计模式,它解决了关于客户端事务管理以及 EJB 中的很多常见 问题。这种设计模式背后最基本的原则是,客户端功能被包装在所谓”命令\(command\)“中, 提交给服务器端以便执行。该命令可能包含了一个或多个对领域服务方法的调用。然而,这 些领域服务方法的调用都是通过服务器端的被称为“命令实现\(Command Implementation\)” 的对象去执行的,而不是在客户端执行。使用命令模式,使得用户可以从客户端对领域服务 组件发起单一请求,并同时允许服务器端而不是客户端来管理事务处理过程。

服务器端代理模式的机制类似,唯一不同的是,它没有使用类似于命令模式的框架,而是 简单地将客户侧的业务代理逻辑放置在服务器端的代理对象中去了。最终结果是一样的,事 务处理过程被移到了服务器端,并且客户端对服务器的请求从多个减少到一个。

**“服务器端代理拥有事务的设计模式”是“领域服务拥有事务模式”的特例。两者的主要区别在 于,如果使用命令模式,会有“一个独立的对象”拥有事务,而不是由“一类组件”拥有事务。 **例如,如果您的应用包含 40 个不同的领域服务,在“领域服务拥有事务模式”下,可能由 40 个 bean 去管理事务。然而,在“服务器端代理拥有事务的设计模式”下,您只需要一个 bean \(命令执行者,Command Processor\)去管理事务。

